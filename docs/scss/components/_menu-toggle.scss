@use "sass:map";
@use "../__core/variables" as *;
@use "../__core/mixins" as *;

.menu-toggle {
  @include visually-hidden;

  @include breakpoint($nav-break) {
    display: none;
  }
}

.menu-toggle-button {
  display: block;
  cursor: pointer;
  border: 0;
  overflow: hidden;
  background: transparent;
  appearance: none;
  user-select: none;

  @include breakpoint($nav-break) {
    display: none;
  }
}

/// Visibility has to have a different delay on default state vs open state
/// Adding mixin so transitions are managed in one place instead of 2
@mixin menu-toggle-transitions($is-open: true) {
  @if $is-open {
    visibility: visible;
  } @else {
    visibility: hidden;
  }

  $visibility-delay: 0s;

  @if $is-open == false {
    $visibility-delay: 0.4s;
  }

  transition:
    visibility 0s    $visibility-delay,
    width      0.25s ease-in-out;
}

// NOTE: the JS solution is more accessible

#mobile-menu-toggle ~ .menu-toggle-toggleable,
.menu-toggle-toggleable.js {
  @include menu-toggle-transitions(false);

  width: 0;
  overflow: hidden;
  background: #ffffff;

  @include breakpoint($nav-break) {
    overflow: visible;
    visibility: visible;
  }
}

#mobile-menu-toggle:checked ~ .menu-toggle-toggleable,
.menu-toggle-toggleable.js.open {
  @include menu-toggle-transitions;

  width: $fixed-sidebar-width;
}
