{"version":3,"file":"uxdot-demo.js","sourceRoot":"","sources":["uxdot-demo.ts"],"names":[],"mappings":"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","sourcesContent":["import { html } from 'lit-html';\n\nimport { customElement } from 'lit/decorators/custom-element.js';\nimport { property } from 'lit/decorators/property.js';\n\nimport styles from './uxdot-demo.css';\n\nimport { isServer, LitElement } from 'lit';\nimport type { RhCodeBlock } from 'elements/rh-code-block/rh-code-block.js';\n\n@customElement('uxdot-demo')\nexport class UxdotDemo extends LitElement {\n  static styles = [styles];\n\n  /** For these tags, do not center the primary-demo content in the frame */\n  private static tagsWithFullWidthDemos = new Set([\n    'rh-back-to-top',\n    'rh-footer',\n    'rh-jump-links',\n    'rh-navigation-primary',\n    'rh-navigation-secondary',\n    'rh-subnav',\n  ]);\n\n  @property() tag!: string;\n\n  @property() demo!: string;\n\n  @property({\n    attribute: 'attribute-knobs',\n    converter: {\n      fromAttribute(str) {\n        return str?.split(/,|\\s/) ?? [];\n      },\n    },\n  }) attributeKnobs: string[] = [];\n\n  @property({ attribute: 'demo-title' }) demoTitle!: string;\n\n  @property({ attribute: 'demo-url' }) demoUrl!: string;\n\n  @property({ attribute: 'demo-source-url' }) demoSourceUrl!: string;\n\n  @property({ attribute: 'demo-file-path' }) demoFilePath!: string;\n\n  get #iframe() {\n    const iframe = this.shadowRoot?.querySelector('iframe');\n    if (!iframe) {\n      throw new Error('iframe not found');\n    }\n    return iframe;\n  }\n\n  render() {\n    return html`\n      <div id=\"container\">\n        <div id=\"preview\">\n          <iframe loading=\"lazy\"\n                  style=\"opacity: 0\"\n                  onload=\"this.style.opacity=1\"\n                  title=\"${this.demoTitle}\"\n                  src=\"${this.demoUrl}\"></iframe>\n          <rh-disclosure id=\"knobs-drawer\" summary=\"Edit element properties\">\n            <div id=\"knobs\" role=\"list\"><slot name=knobs></slot></div>\n          </rh-disclosure>\n        </div>\n        <rh-card id=\"code\"\n                 ssr-hint-has-slotted-default\n                 ssr-hint-has-slotted=\"footer\">\n          <rh-tabs class=\"code-tabs\" active-index=\"0\">\n            <rh-tab slot=\"tab\" active>HTML</rh-tab>\n            <rh-tab-panel><slot name=\"html\"></slot></rh-tab-panel>\n            <rh-tab slot=\"tab\">CSS</rh-tab>\n            <rh-tab-panel><slot name=\"css\"></slot></rh-tab-panel>\n            <rh-tab slot=\"tab\">JS</rh-tab>\n            <rh-tab-panel><slot name=\"js\"></slot></rh-tab-panel>\n          </rh-tabs>\n          <rh-button slot=\"footer\"\n                     variant=\"link\"\n                     icon=\"expand\"\n                     icon-set=\"ui\"\n                     @click=\"${this.#toggleFullscreen}\">View fullscreen</rh-button>\n          <rh-button slot=\"footer\"\n                     variant=\"link\"\n                     icon=\"refresh\"\n                     icon-set=\"ui\"\n                     @click=\"${this.#reloadIframe}\">Reload</rh-button>\n          <a slot=\"footer\" href=\"${this.demoSourceUrl}\">View source on GitHub <rh-icon set=\"ui\" icon=\"code\"></rh-icon></a></rh-cta>\n          <a slot=\"footer\" href=\"${this.demoUrl}\" target=\"_blank\">View in new window <rh-icon set=\"ui\" icon=\"duplicate\"></rh-icon></a></rh-cta>\n        </rh-card>\n      </div>\n    `;\n  }\n\n  firstUpdated() {\n    this.#initIframe();\n  }\n\n  #toggleFullscreen() {\n    if (document.fullscreenElement === this) {\n      document.exitFullscreen();\n    } else {\n      this.requestFullscreen();\n    }\n  }\n\n  #reloadIframe() {\n    this.shadowRoot?.querySelector('iframe')?.contentWindow?.location.reload();\n    this.#initIframe();\n  }\n\n  async #initIframe() {\n    if (!this.#loadedPromises.has(this.#iframe.contentWindow!)) {\n      this.#loadedPromises.set(this.#iframe.contentWindow!, new Promise(resolve =>\n        this.#iframe.contentWindow?.addEventListener('DOMContentLoaded', () => resolve())));\n    }\n    await this.#loadedPromises.get(this.#iframe.contentWindow!);\n    if (!isServer && this.demo === this.tag && !UxdotDemo.tagsWithFullWidthDemos.has(this.tag)) {\n      const { contentDocument } = this.#iframe;\n      if (contentDocument) {\n        const style = contentDocument.createElement('style');\n        style.textContent = /* css */`\n          body {\n            padding: var(--rh-space-3xl, 48px);\n          }\n        `;\n        contentDocument.body.append(style);\n      }\n    }\n  }\n\n  #loadedPromises = new WeakMap<Window, Promise<void>>();\n\n  async #getDemoElement() {\n    await this.#loadedPromises.get(this.#iframe.contentWindow!);\n    const element: LitElement | null | undefined =\n        this.#iframe.contentWindow?.document.querySelector(this.tag);\n    if (element) {\n      return element;\n    } else {\n      throw new Error(`element ${this.tag} not found`);\n    }\n  }\n\n  async setDemoElementAttribute(name: string, value: string | boolean | null) {\n    await this.updateComplete;\n    const element = await this.#getDemoElement();\n    if (value === null || value === '') {\n      element.removeAttribute(name);\n    } else if (typeof value === 'boolean') {\n      element.toggleAttribute(name, value);\n    } else {\n      element.setAttribute(name, value);\n    }\n    await element.updateComplete;\n    const htmlSlot: HTMLSlotElement | null = this.shadowRoot!.querySelector('slot[name=html]')!;\n    const [htmlBlock] = htmlSlot.assignedElements() as RhCodeBlock[];\n    htmlBlock.setAttribute('highlighting', 'client');\n    htmlBlock.setAttribute('language', 'html');\n    htmlBlock.toggleAttribute('wrap', true);\n    await htmlBlock.updateComplete;\n    htmlBlock.innerHTML = `<script type=\"text/html\">${element.outerHTML}</script>`;\n    for (const knob of this.querySelectorAll('uxdot-knob-attribute')) {\n      knob.requestUpdate();\n    }\n  }\n\n  async getDemoElementAttribute(name: string) {\n    await this.updateComplete;\n    const element = await this.#getDemoElement();\n    return element.getAttribute(name);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'uxdot-demo': UxdotDemo;\n  }\n}\n"]}