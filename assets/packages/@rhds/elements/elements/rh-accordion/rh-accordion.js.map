{"version":3,"file":"rh-accordion.js","sourceRoot":"","sources":["rh-accordion.ts"],"names":[],"mappings":"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","sourcesContent":["import { LitElement, html, type TemplateResult } from 'lit';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { customElement } from 'lit/decorators/custom-element.js';\nimport { property } from 'lit/decorators/property.js';\n\nimport { observes } from '@patternfly/pfe-core/decorators/observes.js';\nimport { provide } from '@lit/context';\n\nimport { colorContextConsumer, type ColorTheme } from '../../lib/context/color/consumer.js';\nimport { colorContextProvider, type ColorPalette } from '../../lib/context/color/provider.js';\n\nimport { NumberListConverter, ComposedEvent } from '@patternfly/pfe-core';\nimport { Logger } from '@patternfly/pfe-core/controllers/logger.js';\n\nimport { RhAccordionHeader, AccordionHeaderChangeEvent } from './rh-accordion-header.js';\nimport { RhAccordionPanel } from './rh-accordion-panel.js';\n\nimport { context, type RhAccordionContext } from './context.js';\n\nimport styles from './rh-accordion.css';\n\nexport class AccordionExpandEvent extends ComposedEvent {\n  constructor(\n    public toggle: RhAccordionHeader,\n    public panel: RhAccordionPanel,\n  ) {\n    super('expand');\n  }\n}\n\nexport class AccordionCollapseEvent extends ComposedEvent {\n  constructor(\n    public toggle: RhAccordionHeader,\n    public panel: RhAccordionPanel,\n  ) {\n    super('collapse');\n  }\n}\n\n/**\n * An accordion is a stacked list of panels which allows users to expand or collapse information when selected. They feature panels that consist of a section text label and a caret icon that collapses or expands to reveal more information.\n * @summary Expands or collapses a stacked list of panels\n * @fires {AccordionExpandEvent} expand - when a panel expands\n * @fires {AccordionCollapseEvent} collapse - when a panel collapses\n * @slot - Place the `rh-accordion-header` and `rh-accordion-panel` elements here.\n * @attr  [accents=inline] Position accents in the header either inline or bottom\n */\n@customElement('rh-accordion')\nexport class RhAccordion extends LitElement {\n  static readonly styles = [styles];\n\n  static isAccordion(target: EventTarget | null): target is RhAccordion {\n    return target instanceof RhAccordion;\n  }\n\n  static isHeader(target: EventTarget | null): target is RhAccordionHeader {\n    return target instanceof RhAccordionHeader;\n  }\n\n  static isPanel(target: EventTarget | null): target is RhAccordionPanel {\n    return target instanceof RhAccordionPanel;\n  }\n\n  static isAccordionChangeEvent(event: Event): event is AccordionHeaderChangeEvent {\n    return event instanceof AccordionHeaderChangeEvent;\n  }\n\n  /**\n   * Sets accordion header's accents position to inline or bottom\n   */\n  @property({ attribute: true, reflect: true }) accents?: 'inline' | 'bottom';\n\n  /**\n   * If this accordion uses large styles\n   */\n  @property({ reflect: true, type: Boolean }) large = false;\n\n  /**\n   * Color Palette for this accordion.\n   * @see https://ux.redhat.com/theming/color-palettes/\n   */\n  @colorContextProvider()\n  @property({ reflect: true, attribute: 'color-palette' }) colorPalette?: ColorPalette;\n\n  @colorContextConsumer() private on?: ColorTheme;\n\n  /**\n   * Sets and reflects the currently expanded accordion 0-based indexes.\n   * Use commas to separate multiple indexes.\n   * ```html\n   * <pf-accordion expanded-index=\"1,2\">\n   *   ...\n   * </pf-accordion>\n   * ```\n   */\n  @property({\n    attribute: 'expanded-index',\n    converter: NumberListConverter,\n    hasChanged(value, old) {\n      return JSON.stringify(old) !== JSON.stringify(value);\n    },\n  })\n  get expandedIndex() {\n    return this.#expandedIndex;\n  }\n\n  set expandedIndex(value) {\n    this.#expandedIndex = value;\n    this.#expanded = !!this.#expandedIndex.length;\n    this.headers.forEach((header, i) => {\n      const expanded = this.#expandedIndexSet.has(i);\n      header.expanded = expanded;\n      const panel = this.panels[i];\n      if (panel) {\n        panel.expanded = expanded;\n        panel.hidden = !expanded;\n      }\n    });\n  }\n\n  /** All headers for this accordion */\n  get headers() {\n    return this.#allHeaders();\n  }\n\n  /** All panels for this accordion */\n  get panels() {\n    return this.#allPanels();\n  }\n\n  #expandedIndexSet = new Set<number>();\n\n  #expanded = false;\n\n  #expandedIndex: number[] = [];\n\n  #logger = new Logger(this);\n\n  #mo = new MutationObserver(() => this.updateAccessibility());\n\n  @provide({ context }) private ctx = this.#makeContext();\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.addEventListener('change', this.#onChange as EventListener);\n    this.#mo.observe(this, { childList: true });\n    this.updateAccessibility();\n  }\n\n  override render(): TemplateResult {\n    const { on, large } = this;\n    const expanded = this.#expanded;\n    return html`\n      <div id=\"container\"\n           class=\"${classMap({\n             on: true,\n             large,\n             [on ?? 'light']: true,\n             expanded,\n           })}\"><slot></slot></div>\n    `;\n  }\n\n  protected override async getUpdateComplete(): Promise<boolean> {\n    const c = await super.getUpdateComplete();\n    const results = await Promise.all([\n      ...this.headers.map(x => x.updateComplete),\n      ...this.panels.map(x => x.updateComplete),\n    ]);\n    return c && results.every(Boolean);\n  }\n\n  override firstUpdated() {\n    this.headers.forEach((header, index) => {\n      if (header.expanded) {\n        this.#expandedIndexSet.add(index);\n      }\n    });\n    this.expandedIndex = [...this.#expandedIndexSet];\n    this.#expanded = !!this.#expandedIndex.length;\n  }\n\n  @observes('accents')\n  @observes('large')\n  @observes('expandedIndex')\n  private contextChanged() {\n    this.ctx = this.#makeContext();\n  }\n\n  #makeContext(): RhAccordionContext {\n    const { accents = 'inline', large } = this;\n    const expanded = this.#expanded;\n    return { accents, large, expanded };\n  }\n\n  #panelForHeader(header: RhAccordionHeader) {\n    const next = header.nextElementSibling;\n    if (!RhAccordion.isPanel(next)) {\n      return next?.querySelector('rh-accordion-panel');\n    } else {\n      return next;\n    }\n  }\n\n  #expand(index: number) {\n    // If this index is not already listed in the expandedSets array, add it\n    this.expandedIndex = [...this.#expandedIndexSet.add(index)];\n  }\n\n  #collapse(index: number) {\n    if (this.#expandedIndexSet.delete(index)) {\n      this.expandedIndex = [...this.#expandedIndexSet];\n    }\n  }\n\n  #onChange(event: AccordionHeaderChangeEvent) {\n    if (RhAccordion.isAccordionChangeEvent(event)) {\n      const index = this.#getIndex(event.target);\n      if (event.expanded) {\n        this.expand(index, event.accordion);\n      } else {\n        this.collapse(index);\n      }\n    }\n    this.requestUpdate('expandedIndex');\n  }\n\n  #allHeaders(accordion: RhAccordion = this): RhAccordionHeader[] {\n    return Array.from(accordion.children).filter((x): x is RhAccordionHeader =>\n      x instanceof RhAccordionHeader\n    );\n  }\n\n  #allPanels(accordion: RhAccordion = this): RhAccordionPanel[] {\n    return Array.from(accordion.children).filter((x =>\n      RhAccordion.isPanel(x)) as typeof RhAccordion.isPanel\n    );\n  }\n\n  #getIndex(el: Element | null) {\n    if (RhAccordion.isHeader(el)) {\n      return this.headers.findIndex(header => header.id === el.id);\n    }\n\n    if (RhAccordion.isPanel(el)) {\n      return this.panels.findIndex(panel => panel.id === el.id);\n    }\n\n    this.#logger.warn('The #getIndex method expects to receive a header or panel element.');\n    return -1;\n  }\n\n  /**\n   * Initialize the accordion by connecting headers and panels\n   * with aria controls and labels; set up the default disclosure\n   * state if not set by the author; and check the URL for default\n   * open\n   */\n  public updateAccessibility() {\n    const { headers } = this;\n\n    // For each header in the accordion, attach the aria connections\n    for (const header of headers) {\n      const panel = this.#panelForHeader(header);\n      if (panel) {\n        header.setAttribute('aria-controls', panel.id);\n        panel.setAttribute('aria-labelledby', header.id);\n      }\n    }\n  }\n\n  /**\n   * Accepts a 0-based index value (integer) for the set of accordion items to expand or collapse.\n   * @param index header index to toggle\n   */\n  public async toggle(index: number) {\n    const { headers } = this;\n    const header = headers[index];\n\n    if (!header.expanded) {\n      await this.expand(index);\n    } else {\n      await this.collapse(index);\n    }\n  }\n\n  /**\n   * Accepts a 0-based index value (integer) for the set of accordion items to expand.\n   * Accepts an optional parent accordion to search for headers and panels.\n   * @param index header index to toggle\n   * @param parentAccordion target accordion to expand in\n   */\n  public async expand(index: number, parentAccordion?: RhAccordion) {\n    const allHeaders: RhAccordionHeader[] = this.#allHeaders(parentAccordion);\n\n    const header = allHeaders[index];\n    if (!header) {\n      return;\n    }\n\n    const panel = this.#panelForHeader(header);\n    if (!panel) {\n      return;\n    }\n\n    // If the header and panel exist, open both\n    this.#expand(index);\n\n    header.focus();\n\n    this.dispatchEvent(new AccordionExpandEvent(header, panel));\n\n    await this.updateComplete;\n  }\n\n  /**\n   * Expands all accordion items.\n   */\n  public async expandAll() {\n    this.headers.forEach((_, i) => this.#expand(i));\n    await this.updateComplete;\n  }\n\n  /**\n   * Accepts a 0-based index value (integer) for the set of accordion items to collapse.\n   * @param index header index to collapse\n   */\n  public async collapse(index: number) {\n    const header = this.headers.at(index);\n    const panel = this.panels.at(index);\n\n    if (!header || !panel) {\n      return;\n    }\n\n    this.#collapse(index);\n\n    this.dispatchEvent(new AccordionCollapseEvent(header, panel));\n    await this.updateComplete;\n  }\n\n  /**\n   * Collapses all accordion items.\n   */\n  public async collapseAll() {\n    this.headers.forEach((_, i) => this.#collapse(i));\n    await this.updateComplete;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'rh-accordion': RhAccordion;\n  }\n\n  interface HTMLElementEventMap {\n    'expand': AccordionExpandEvent;\n    'collapse': AccordionCollapseEvent;\n  }\n}\n"]}