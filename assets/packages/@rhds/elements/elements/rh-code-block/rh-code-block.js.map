{"version":3,"file":"rh-code-block.js","sourceRoot":"","sources":["rh-code-block.ts"],"names":[],"mappings":"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","sourcesContent":["import type { DirectiveResult } from 'lit-html/directive.js';\nimport { CSSResult, LitElement, html, isServer, type PropertyValues } from 'lit';\nimport { customElement } from 'lit/decorators/custom-element.js';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { styleMap } from 'lit/directives/style-map.js';\nimport { property } from 'lit/decorators/property.js';\nimport { state } from 'lit/decorators/state.js';\nimport { ifDefined } from 'lit-html/directives/if-defined.js';\n\nimport { SlotController } from '@patternfly/pfe-core/controllers/slot-controller.js';\nimport { Logger } from '@patternfly/pfe-core/controllers/logger.js';\n\nimport { themable } from '@rhds/elements/lib/themable.js';\n\nimport style from './rh-code-block.css';\n\n/**\n * Returns a string with common indent stripped from each line. Useful for templating HTML\n * @param str indented string\n */\nfunction dedent(str: string) {\n  const stripped = str.replace(/^\\n/, '');\n  const match = stripped.match(/^\\s+/);\n  const out = match ? stripped.replace(new RegExp(`^${match[0]}`, 'gm'), '') : str;\n  return out.trim();\n}\n\ninterface CodeLineHeightsInfo {\n  lines: string[];\n  lineHeights: (number | undefined)[];\n  sizer: HTMLElement;\n  oneLinerHeight: number;\n}\n\nconst prismApplyPromises = new WeakMap();\n\nexport class RhCodeBlockCopyEvent extends Event {\n  constructor(\n    /** Text content to copy */\n    public content: string\n  ) {\n    super('copy', { bubbles: true, cancelable: true });\n  }\n}\n\n/**\n * A code block applies special formatting to sections of code.\n *\n * @alias code-block\n *\n * @summary Formats code strings within a container\n * @event {RhCodeBlockCopyEvent} copy - fired when the user requests to copy the code block text.\n *                                      Modify the `event.content` field to change the copied text\n *                                      (e.g. to remove a prompt from a shell command)\n */\n@customElement('rh-code-block')\n@themable\nexport class RhCodeBlock extends LitElement {\n  private static actionIcons = new Map([\n    ['wrap', html`\n      <svg xmlns=\"http://www.w3.org/2000/svg\"\n           role=\"presentation\"\n           fill=\"currentColor\"\n           viewBox=\"0 0 20 20\">\n        <path d=\"M19 0c.313.039.781-.077 1 .057V20c-.313-.039-.781.077-1-.057V0ZM10.82 4.992C9.877 4.996 8.31 5.57 8.174 6c1.21.03 2.432-.073 3.635.08 2.181.383 3.677 2.796 3.066 4.922-.41 1.753-2.108 2.995-3.877 3.014L11 14H5.207l2.682-2.682-.707-.707L3.293 14.5l3.889 3.889.707-.707L5.207 15h5.736l.004-.008c1.444.005 2.896-.59 3.832-1.722 1.65-1.82 1.612-4.85-.08-6.63A5 5 0 0 0 11 5a1.948 1.948 0 0 0-.18-.008z\"/>\n        <path d=\"M4 5h7c-.039.313.077.781-.057 1H4V5ZM0 0c.313.039.781-.077 1 .057V20c-.313-.039-.781.077-1-.057V0Z\"/>\n      </svg>\n    `],\n    ['wrap-active', html`\n      <svg xmlns=\"http://www.w3.org/2000/svg\"\n           role=\"presentation\"\n           fill=\"none\"\n           viewBox=\"0 0 21 20\">\n        <path fill=\"currentColor\" d=\"M12 13h1v7h-1zM12 0h1v7h-1z\"/>\n        <path stroke=\"currentColor\" d=\"M16.465 6.464 20 10l-3.535 3.536\"/>\n        <path fill=\"currentColor\" d=\"M3 9.5h17v1H3zM0 0h1v20H0z\"/>\n      </svg>\n    `],\n    ['copy', html`\n      <svg xmlns=\"http://www.w3.org/2000/svg\"\n           version=\"1.1\"\n           viewBox=\"0 0 20 20\">\n        <path fill=\"currentColor\" d=\"M12 0H2C.9 0 0 .9 0 2v10h1V2c0-.6.4-1 1-1h10V0z\"/>\n        <path fill=\"currentColor\" d=\"M18 20H8c-1.1 0-2-.9-2-2V8c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2v10c0 1.1-.9 2-2 2zM8 7c-.6 0-1 .4-1 1v10c0 .6.4 1 1 1h10c.6 0 1-.4 1-1V8c0-.6-.4-1-1-1H8z\"/>\n      </svg>\n    `],\n  ]);\n\n  static styles = [style];\n\n  /**\n   * Space- or comma-separated list of code block action buttons to display, containing either 'copy', 'wrap', or both.\n   * 'copy' adds a button that copies the text content to the clipboard. 'wrap' adds a button that toggles line wrap.\n   *\n   * To override the default labels, e.g. for purposes of internationalization, use the\n   * `action-label-copy` and `action-label-wrap` slots. Each slot may receive two elements,\n   * one for the action's default state (e.g. \"Copy to clipboard\"),\n   * and one for the actions alternative state, e.g. \"Copied!\".\n   * The active-state element must have the attributes `hidden data-code-block-state=\"active\"`\n   *\n   * @example html```\n   *          <rh-code-block actions=\"copy wrap\">\n   *            <span slot=\"action-label-copy\">Copy to Clipboard</span>\n   *            <span slot=\"action-label-copy\" hidden data-code-block-state=\"active\">Copied!</span>\n   *            <span slot=\"action-label-copy\" hidden data-code-block-state=\"failed\">Copy failed!</span>\n   *            <span slot=\"action-label-wrap\">Toggle word wrap</span>\n   *            <span slot=\"action-label-wrap\" hidden data-code-block-state=\"active\">Toggle overflow</span>\n   *          </rh-code-block>\n   *          ```\n   */\n  @property({\n    reflect: true,\n    converter: {\n      fromAttribute(value) {\n        return ((value ?? '').split(/\\s+|,/) ?? []).map(x => x.trim()).filter(Boolean);\n      },\n      toAttribute(value) {\n        return Array.isArray(value) ? value.join(' ') : '';\n      },\n    },\n  }) actions: ('copy' | 'wrap')[] = [];\n\n  /**\n   * When set to \"client\", `<rh-code-block>` will automatically highlight the source using Prism.js\n   * When set to \"Prerendered\", `<rh-code-block>` will apply supported RHDS styles to children with\n   * prismjs classnames in the element's root.\n   */\n  @property() highlighting?: 'client' | 'prerendered';\n\n  /** When set along with `highlighting=\"client\"`, this grammar will be used to highlight source code */\n  @property() language?:\n    | 'html'\n    | 'css'\n    | 'javascript'\n    | 'typescript'\n    | 'bash'\n    | 'ruby'\n    | 'yaml'\n    | 'json';\n\n  /** When set, the code block displays with compact spacing */\n  @property({ type: Boolean, reflect: true }) compact = false;\n\n  /** When set, the code block source code will be dedented */\n  @property({ type: Boolean, reflect: true }) dedent = false;\n\n  /** When set, the code block is resizable */\n  @property({ type: Boolean, reflect: true }) resizable = false;\n\n  /** When set, the code block occupies it's full height, without scrolling */\n  @property({ type: Boolean, reflect: true, attribute: 'full-height' }) fullHeight = false;\n\n  /** When set, lines in the code snippet wrap */\n  @property({ type: Boolean }) wrap = false;\n\n  /** When set to `hidden`, the code block's line numbers are hidden */\n  @property({ reflect: true, attribute: 'line-numbers' }) lineNumbers?: 'hidden';\n\n  @state() private copyButtonState: 'default' | 'active' | 'failed' = 'default';\n\n  #logger = new Logger(this);\n\n  #slots = new SlotController(\n    this,\n    null,\n    'action-label-copy',\n    'copy-failed',\n    'action-label-wrap',\n    'show-more',\n    'show-less',\n    'legend',\n  );\n\n  #prismOutput?: DirectiveResult;\n\n  #isIntersecting = false;\n  #io = new IntersectionObserver(rs => {\n    const old = this.#isIntersecting;\n    const isIntersecting = rs.some(r => r.isIntersecting);\n    this.#isIntersecting = isIntersecting;\n    if (old !== isIntersecting) {\n      this.requestUpdate();\n    }\n    this.#computeLineNumbers();\n  }, { rootMargin: '50% 0px' });\n\n  #ro = new ResizeObserver(() => this.#computeLineNumbers());\n\n  #lines: string[] = [];\n  #lineHeights: `${string}px`[] = [];\n\n  override connectedCallback() {\n    super.connectedCallback();\n    if (!isServer) {\n      this.#ro.observe(this);\n      this.#io.observe(this);\n    }\n    this.#onSlotChange();\n  }\n\n  override disconnectedCallback() {\n    super.disconnectedCallback();\n    this.#ro.disconnect();\n    this.#io.disconnect();\n  }\n\n  render() {\n    const { fullHeight, wrap, resizable, compact } = this;\n    const expandable = this.#lines.length > 5;\n    const truncated = expandable && !fullHeight;\n    const actions = !!this.actions.length;\n    const isIntersecting = this.#isIntersecting;\n    const actionCopyLabelledBy =\n       this.copyButtonState === 'default' ?\n         'copy-to-clipboard-label'\n         : this.copyButtonState === 'active' ?\n           'copied-label'\n           : 'copy-failed-label';\n    return html`\n      <div id=\"container\"\n           class=\"${classMap({ actions, compact, expandable, fullHeight, isIntersecting, resizable, truncated, wrap })}\"\n           @code-action=\"${this.#onCodeAction}\">\n        <div id=\"content-lines\" tabindex=\"${ifDefined((!fullHeight || undefined) && 0)}\">\n          <div id=\"sizers\" aria-hidden=\"true\"></div>\n          <ol id=\"line-numbers\" inert aria-hidden=\"true\">${this.#lineHeights.map((height, i) => html`\n            <li style=\"${styleMap({ height })}\">${i + 1}</li>`)}\n          </ol>\n          <pre id=\"prism-output\"\n               class=\"language-${this.language}\"\n               ?hidden=\"${!this.#prismOutput}\">${this.#prismOutput}</pre>\n          <!--\n            A non-executable script tag containing the sample content. JavaScript\n            samples should use the type \\`text/sample-javascript\\`. HTML samples\n            containing script tags must escape the closing \\`</script>\\` tag. Can\n            also be a \\`<pre>\\` tag.\n          -->\n          <slot id=\"content\"\n                ?hidden=\"${!!this.#prismOutput}\"\n                @slotchange=\"${this.#onSlotChange}\"></slot>\n        </div>\n\n        <div id=\"actions\"\n             @click=\"${this.#onActionsClick}\"\n             @keyup=\"${this.#onActionsKeyup}\">\n        ${!this.actions.includes('copy') ? '' : html`\n          <rh-tooltip silent>\n            <!-- Tooltip content for the copy action button -->\n            <slot slot=\"content\" name=\"action-label-copy\">\n              <span ?hidden=\"${this.copyButtonState !== 'default'}\" id=\"copy-to-clipboard-label\">Copy to Clipboard</span>\n              <span ?hidden=\"${this.copyButtonState !== 'active'}\" id=\"copied-label\">Copied!</span>\n              <span ?hidden=\"${this.copyButtonState !== 'failed'}\" id=\"copy-failed-label\">Copy failed!</span>\n            </slot>\n            <button id=\"action-copy\"\n                   class=\"shadow-fab\"\n                   data-code-block-action=\"copy\"\n                   aria-labelledby=\"${actionCopyLabelledBy}\">\n             ${RhCodeBlock.actionIcons.get('copy')}\n            </button>\n          </rh-tooltip>`}\n          ${!this.actions.includes('wrap') ? '' : html`\n            <rh-tooltip silent>\n             <!-- Tooltip content for the wrap action button -->\n             <slot id=\"label-wrap\" slot=\"content\" name=\"action-label-wrap\">\n               <span ?hidden=\"${this.wrap}\">Toggle word wrap</span>\n               <span ?hidden=\"${!this.wrap}\"\n                     data-code-block-state=\"active\">Toggle overflow</span>\n             </slot>\n             <button id=\"action-wrap\"\n                     class=\"shadow-fab\"\n                     data-code-block-action=\"wrap\"\n                     aria-labelledby=\"label-wrap\">\n               ${RhCodeBlock.actionIcons.get(this.wrap ? 'wrap-active' : 'wrap')}\n             </button>\n            </rh-tooltip>\n          `}\n        </div>\n\n        <button id=\"expand\"\n                ?hidden=\"${!expandable}\"\n                aria-controls=\"content-lines\"\n                aria-expanded=\"${String(!!fullHeight) as 'true' | 'false'}\"\n                @click=\"${this.#onClickExpand}\"\n                aria-labelledby=\"${this.fullHeight === true ? 'show-less-label' : 'show-more-label'}\">\n          <span ?hidden=\"${this.fullHeight}\" id=\"show-more-label\">\n            <!-- text content for the expandable toggle button when the code block is collapsed. -->\n            <slot name=\"show-more\">Show more</slot>\n          </span>\n          <span ?hidden=\"${!this.fullHeight}\" id=\"show-less-label\">\n          <!-- text content for the expandable toggle button when the code block is expanded. -->\n            <slot name=\"show-less\">Show less</slot>\n          </span>\n          <svg xmlns=\"http://www.w3.org/2000/svg\"\n               fill=\"currentColor\"\n               viewBox=\"0 0 11 7\">\n            <path d=\"M4.919.239.242 4.847a.801.801 0 0 0 0 1.148l.778.766a.83.83 0 0 0 1.165 0L5.5 3.495 8.815 6.76a.83.83 0 0 0 1.165 0l.778-.766a.802.802 0 0 0 0-1.148L6.08.239a.826.826 0 0 0-1.162 0Z\"/>\n          </svg>\n        </button>\n      </div>\n\n      <!-- \\`<dl>\\` element containing rh-badges in the \\`<dt>\\` and legend text in the \\`<dd>\\` elements -->\n      <slot name=\"legend\" ?hidden=\"${this.#slots.isEmpty('legend')}\"></slot>\n    `;\n  }\n\n  protected override firstUpdated(): void {\n    this.#computeLineNumbers();\n  }\n\n  protected override updated(changed: PropertyValues<this>): void {\n    if (changed.has('wrap')) {\n      this.#wrapChanged();\n    }\n    if (this.actions.length && !isServer) {\n      import('@rhds/elements/rh-tooltip/rh-tooltip.js');\n    }\n  }\n\n  async #onSlotChange() {\n    switch (this.highlighting) {\n      case 'client': await this.#highlightWithPrism(); break;\n      // TODO: if we ever support other tokenizers e.g. highlightjs,\n      // dispatch here off of some supplemental attribute like `tokenizer=\"highlightjs\"`\n      case 'prerendered': await this.#applyPrismPrerenderedStyles(); break;\n    }\n    this.#computeLineNumbers();\n  }\n\n  async #applyPrismPrerenderedStyles() {\n    let root: Node;\n    if (!isServer && !prismApplyPromises.has((root = this.getRootNode()))) {\n      if (root instanceof Document || root instanceof ShadowRoot) {\n        prismApplyPromises.set(root, (async function() {\n          const { preRenderedLightDomStyles: { styleSheet } } = await import('./prism.css.js');\n          root.adoptedStyleSheets = [...root.adoptedStyleSheets, styleSheet!];\n        })());\n      }\n    }\n  }\n\n  async #highlightWithPrism() {\n    if (!isServer) {\n      const { highlight, prismStyles } = await import('./prism.js');\n      const styleSheet =\n          prismStyles instanceof CSSStyleSheet ? prismStyles\n        : (prismStyles as CSSResult).styleSheet;\n      if (!this.shadowRoot!.adoptedStyleSheets.includes(styleSheet!)) {\n        this.shadowRoot!.adoptedStyleSheets = [\n          ...this.shadowRoot!.adoptedStyleSheets as CSSStyleSheet[],\n          styleSheet!,\n        ];\n      }\n      const scripts = this.querySelectorAll('script[type]:not([type=\"javascript\"])');\n      const preprocess = this.dedent ? dedent : (x: string) => x;\n      const textContent = preprocess(Array.from(scripts, x => x.textContent).join(''));\n      this.#prismOutput = await highlight(textContent, this.language);\n      this.requestUpdate('#prismOutput', {});\n      await this.updateComplete;\n    }\n  }\n\n  async #wrapChanged() {\n    await this.updateComplete;\n    this.#computeLineNumbers();\n    this.#setSlottedLabelState('action-label-wrap', this.wrap ? 'active' : undefined);\n  }\n\n  #setSlottedLabelState(slotName: 'action-label-copy' | 'action-label-wrap', state?: string) {\n    if (this.#slots.hasSlotted(slotName)) {\n      for (const el of this.#slots.getSlotted(slotName)) {\n        if (el instanceof HTMLElement) {\n          el.hidden = el.dataset.codeBlockState !== state;\n        }\n      }\n    }\n  }\n\n  #getSlottedCodeElements() {\n    const slot = this.shadowRoot?.getElementById('content') as HTMLSlotElement;\n    return slot.assignedElements().flatMap(x =>\n        x instanceof HTMLScriptElement\n        || x instanceof HTMLPreElement ? [x]\n      : []);\n  }\n\n  /**\n   * Clone the text content and connect it to the document, in order to calculate the number of lines\n   * @license MIT\n   * Portions copyright prism.js authors (MIT license)\n   */\n  async #computeLineNumbers() {\n    if (!this.#isIntersecting) {\n      return;\n    }\n\n    await this.updateComplete;\n    const codes =\n        this.#prismOutput ? [this.shadowRoot?.getElementById('prism-output')].filter(x => !!x)\n      : this.#getSlottedCodeElements();\n\n    this.#lines = codes.flatMap(element =>\n      element.textContent?.split(/\\n(?!$)/g) ?? []);\n    this.requestUpdate();\n\n    if (this.lineNumbers === 'hidden') {\n      return;\n    }\n\n    const infos: CodeLineHeightsInfo[] = codes.map(element => {\n      const codeElement = this.#prismOutput ? element.querySelector('code') : element;\n      if (codeElement) {\n        const sizer = document.createElement('span');\n        sizer.className = 'sizer';\n        sizer.innerText = '0';\n        sizer.style.display = 'block';\n        this.shadowRoot?.getElementById('sizers')?.appendChild(sizer);\n        return {\n          lines: element.textContent?.split(/\\n(?!$)/g) ?? [],\n          lineHeights: [],\n          sizer,\n          oneLinerHeight: sizer.getBoundingClientRect().height,\n        };\n      }\n    }).filter(x => !!x);\n\n    for (const { lines, lineHeights, sizer, oneLinerHeight } of infos) {\n      lineHeights[lines.length - 1] = undefined; // why?\n      lines.forEach((line, i) => {\n        if (line.length > 1) {\n          const e = sizer.appendChild(document.createElement('span'));\n          e.style.display = 'block';\n          e.textContent = line;\n        } else {\n          lineHeights[i] = oneLinerHeight;\n        }\n      });\n    }\n\n    for (const { sizer, lineHeights } of infos) {\n      let childIndex = 0;\n      for (let i = 0; i < lineHeights.length; i++) {\n        if (lineHeights[i] === undefined) {\n          lineHeights[i] = sizer.children[childIndex++].getBoundingClientRect()?.height ?? 0;\n        }\n      }\n      sizer.remove();\n    }\n\n    this.#lineHeights = infos.flatMap(x =>\n      x.lineHeights?.map(y =>\n        `${y ?? x.oneLinerHeight}px` as const));\n\n    this.requestUpdate('#linesNumbers', 0);\n  }\n\n  #onActionsClick(event: Event) {\n    this.#onCodeAction(event);\n  }\n\n  #onActionsKeyup(event: KeyboardEvent) {\n    switch (event.key) {\n      case 'Enter':\n        return;\n      case ' ':\n        event.preventDefault();\n        this.#onCodeAction(event);\n    }\n  }\n\n  #onCodeAction(event: Event) {\n    const el = event.composedPath().find((x: EventTarget): x is HTMLElement =>\n      x instanceof HTMLElement && !!x.dataset.codeBlockAction);\n    if (el) {\n      switch (el.dataset.codeBlockAction) {\n        case 'copy':\n          return this.#copy();\n        case 'wrap':\n          this.wrap = !this.wrap;\n          this.requestUpdate();\n          return;\n      }\n    }\n  }\n\n  #onClickExpand() {\n    this.fullHeight = !this.fullHeight;\n  }\n\n  #preCopy() {\n    let content: string;\n    if (this.highlighting === 'prerendered') {\n      content =\n        Array.from(\n          this.querySelectorAll('pre'),\n          x => x?.textContent ?? '',\n        ).join('');\n    } else {\n      content = Array.from(\n        this.querySelectorAll('script'),\n        x => x.textContent,\n      ).join('');\n    }\n    const event = new RhCodeBlockCopyEvent(content);\n    if (!this.dispatchEvent(event) || event.defaultPrevented) {\n      throw new Error('copy cancelled');\n    }\n    return event.content;\n  }\n\n  async #copy() {\n    const slot =\n      this.shadowRoot?.querySelector<HTMLSlotElement>('slot[name=\"action-label-copy\"]');\n    const tooltip =\n      slot?.closest('rh-tooltip');\n    if (!tooltip) {\n      return;\n    }\n\n    try {\n      tooltip.hide();\n      const content = this.#preCopy();\n      await navigator.clipboard.writeText(content);\n      this.copyButtonState = 'active';\n      this.#setSlottedLabelState('action-label-copy', 'active');\n    } catch (error) {\n      this.#logger.error(error);\n      this.copyButtonState = 'failed';\n      this.#setSlottedLabelState('action-label-copy', 'failed');\n    }\n    tooltip.show();\n    await new Promise(r => setTimeout(r, 5_000));\n    tooltip.hide();\n    this.copyButtonState = 'default';\n    this.#setSlottedLabelState('action-label-copy', undefined);\n    tooltip.show();\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'rh-code-block': RhCodeBlock;\n  }\n}\n"]}