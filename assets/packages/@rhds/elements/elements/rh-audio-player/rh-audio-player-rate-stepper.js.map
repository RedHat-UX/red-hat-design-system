{"version":3,"file":"rh-audio-player-rate-stepper.js","sourceRoot":"","sources":["rh-audio-player-rate-stepper.ts"],"names":[],"mappings":"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","sourcesContent":["import { LitElement, html } from 'lit';\nimport { customElement } from 'lit/decorators/custom-element.js';\nimport { property } from 'lit/decorators/property.js';\nimport { ifDefined } from 'lit-html/directives/if-defined.js';\n\nimport '@rhds/elements/rh-icon/rh-icon.js';\n\nimport styles from './rh-audio-player-rate-stepper.css';\n\n/**\n */\n@customElement('rh-audio-player-rate-stepper')\nexport class RhAudioPlayerRateStepper extends LitElement {\n  static readonly styles = [styles];\n\n  private static pbrMin = 0.25;\n\n  private static pbrMax = 2;\n\n  private static pbrStep = 0.25;\n\n  private static pbrFixed = 2;\n\n  /** Playback rate */\n  @property({ reflect: true, type: Number, attribute: 'playback-rate' }) playbackRate = 1;\n\n  /** Playback rate */\n  @property({ reflect: true, type: Boolean }) disabled = false;\n\n  /** Playback rate */\n  @property() label?: string;\n\n  /**\n   * gets list of allowable playback rates\n   */\n  get #playbackRates() {\n    const { pbrMax, pbrStep, pbrMin } = RhAudioPlayerRateStepper;\n    return [\n      ...Array(Math.round(pbrMax / pbrStep)).keys()].map(k =>\n      k * pbrStep + pbrMin\n    );\n  }\n\n\n  /** template for playback rate controls */\n  render() {\n    const { pbrFixed } = RhAudioPlayerRateStepper;\n\n    return html`\n      <rh-tooltip>\n        <div>\n          <button id=\"stepdown\"\n                  class=\"tabbable playback-rate-step\"\n                  tabindex=\"-1\"\n                  aria-label=\"<\"\n                  ?disabled=\"${this.disabled || this.playbackRate < 0.5}\"\n                  @click=\"${this.#dec}\">\n            <rh-icon icon=\"caret-left\" set=\"microns\"></rh-icon>\n          </button>\n          <select id=\"playback-rate\"\n                  class=\"tabbable\"\n                  aria-label=\"${ifDefined(this.label)}\"\n                  ?disabled=\"${this.disabled}\"\n                  @click=\"${this.#onPlaybackRateSelect}\"\n                  @change=\"${this.#onPlaybackRateSelect}\"\n                  .value=\"${this.playbackRate?.toFixed(pbrFixed)}\">${this.#playbackRates.map(step => html`\n            <option .value=\"${step.toFixed(pbrFixed)}\"\n                    ?selected=${this.playbackRate.toFixed(pbrFixed) === step.toFixed(pbrFixed)}>\n              ${step.toFixed(pbrFixed)}x\n            </option>`)}\n          </select>\n          <button id=\"stepup\"\n                  class=\"tabbable playback-rate-step\"\n                  tabindex=\"-1\"\n                  aria-label=\">\"\n                  ?disabled=\"${this.disabled || this.playbackRate > 1.75}\"\n                  @click=\"${this.#inc}\">\n            <rh-icon icon=\"caret-right\" set=\"microns\"></rh-icon>\n          </button>\n        </div>\n        <span slot=\"content\">${this.label}</span>\n      </rh-tooltip>\n    `;\n  }\n\n  #onPlaybackRateSelect(event: Event) {\n    if (!this.disabled && event.target instanceof HTMLSelectElement) {\n      const val = !event.target.value ? 1.00 : parseFloat(event.target.value);\n      this.dispatchEvent(new RhAudioPlayerRateSelectEvent(val));\n    }\n  }\n\n  #validPlaybackRate(number: number) {\n    const { pbrMax, pbrStep, pbrMin } = RhAudioPlayerRateStepper;\n    // ensures number between min and maxk\n    const inRange = Math.max(pbrMin, Math.min(pbrMax, number));\n    // used to round number to nearest step\n    const multiplier = 1 / pbrStep;\n    return Math.round(inRange * multiplier) / multiplier;\n  }\n\n  /**\n   * Increases media playback rate by playback rate step value\n   */\n  #inc() {\n    this.#fire(this.playbackRate + RhAudioPlayerRateStepper.pbrStep);\n  }\n\n  /**\n   * Decreases media playback rate by playback rate step value\n   */\n  #dec() {\n    this.#fire(this.playbackRate - RhAudioPlayerRateStepper.pbrStep);\n  }\n\n  #fire(rate: number) {\n    if (this.#validPlaybackRate(rate)) {\n      const event = new RhAudioPlayerRateSelectEvent(rate);\n      this.dispatchEvent(event);\n    }\n  }\n}\n\nexport class RhAudioPlayerRateSelectEvent extends Event {\n  constructor(public playbackRate: number) {\n    super('playback-rate-select', { bubbles: true, cancelable: true });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'rh-audio-player-rate-stepper': RhAudioPlayerRateStepper;\n  }\n  interface HTMLElementEventMap {\n    'playback-rate-select': RhAudioPlayerRateSelectEvent;\n    'rh-audio-player-rate-stepper': RhAudioPlayerRateStepper;\n  }\n}\n"]}