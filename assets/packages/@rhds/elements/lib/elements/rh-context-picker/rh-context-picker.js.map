{"version":3,"file":"rh-context-picker.js","sourceRoot":"","sources":["rh-context-picker.ts"],"names":[],"mappings":"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","sourcesContent":["import { html, LitElement, type PropertyValues } from 'lit';\nimport { customElement } from 'lit/decorators/custom-element.js';\nimport { property } from 'lit/decorators/property.js';\nimport { query } from 'lit/decorators/query.js';\n\nimport { type ColorPalette } from '../../context/color/provider.js';\nimport { colorContextConsumer, type ColorTheme } from '../../context/color/consumer.js';\n\nimport type { Color } from '@rhds/tokens/js/types.js';\nimport {\n  ColorSurfaceDarkest as darkest,\n  ColorSurfaceDarker as darker,\n  ColorSurfaceDark as dark,\n  ColorSurfaceLight as light,\n  ColorSurfaceLighter as lighter,\n  ColorSurfaceLightest as lightest,\n} from '@rhds/tokens/color.js';\n\nimport { styleMap } from 'lit/directives/style-map.js';\nimport { classMap } from 'lit/directives/class-map.js';\n\nimport '@rhds/elements/rh-tooltip/rh-tooltip.js';\n\nimport style from './rh-context-picker.css';\n\nexport class ContextChangeEvent extends Event {\n  constructor(public colorPalette: ColorPalette) {\n    super('change', { bubbles: true });\n  }\n}\n\n@customElement('rh-context-picker')\nexport class RhContextPicker extends LitElement {\n  static formAssociated = true;\n\n  static readonly styles = [style];\n\n  static readonly palettes = new Map<ColorPalette, Color>(Object.entries({\n    darkest,\n    darker,\n    dark,\n    light,\n    lighter,\n    lightest,\n  }) as [ColorPalette, Color][]);\n\n  private static offsets: Partial<Record<ColorPalette, number>> = {\n    darkest: -4,\n    darker: -3,\n    dark: -3,\n    light: -1,\n    lighter: 1,\n    lightest: 2,\n  };\n\n  private static paletteNames = Array.from(RhContextPicker.palettes, ([name]) => name);\n\n  declare shadowRoot: ShadowRoot;\n\n  /** ID of context element to toggle (same root) */\n  @property() target?: string;\n\n  @property() value: ColorPalette = 'darkest';\n\n  @query('#context-range') private range?: HTMLInputElement;\n\n  @colorContextConsumer() private on?: ColorTheme;\n\n  #offset = RhContextPicker.offsets[this.value];\n\n  #internals = this.attachInternals();\n\n  #target: HTMLElement | null = null;\n\n  willUpdate() {\n    this.#offset = RhContextPicker.offsets[this.value];\n  }\n\n  render() {\n    const { on = 'dark', value = 'darkest' } = this;\n    const derivedLabel = this.#internals.ariaLabel ?? Array.from(this.#internals.labels, x => x.textContent).join();\n    return html`\n      <div id=\"container\" class=\"${classMap({ [on]: true })}\">\n          <input id=\"context-range\"\n                 class=\"${classMap({ [value]: true })}\"\n                 name=\"range\"\n                 type=\"range\"\n                 list=\"palettes\"\n                 max=\"5\"\n                 aria-label=\"${derivedLabel}\"\n                 style=\"${styleMap({ '--offset': `${this.#offset}px` })}\"\n                 @input=\"${this.#onInput}\">\n          <datalist id=\"palettes\">${Array.from(RhContextPicker.palettes, ([palette]) => html`\n            <option id=\"option-${palette}\"\n                    value=\"${palette}\"\n                    title=\"${palette}\"\n                    @click=\"${() => this.#setValue(palette)}\">\n              <span class=\"visually-hidden\">${palette}</span>\n            </option>`)}\n          </datalist>\n      </div>\n    `;\n  }\n\n  updated(changedProperties: PropertyValues<this>) {\n    if (changedProperties.has('value') && this.range) {\n      this.range.value = RhContextPicker.paletteNames.indexOf(this.value).toString();\n    }\n  }\n\n  formStateRestoreCallback(state: string) {\n    this.#setValue(state);\n  }\n\n  firstUpdated() {\n    if (this.target) {\n      const root = this.getRootNode() as Document | ShadowRoot;\n      this.#target = root.getElementById(this.target);\n      this.sync();\n    } else {\n      this.#target = this.closest('rh-context-provider');\n    }\n  }\n\n  #onInput(event: Event) {\n    if (event.target instanceof HTMLInputElement) {\n      event.stopPropagation();\n      const value = RhContextPicker.paletteNames[+event.target.value];\n      this.#setValue(value);\n    }\n  }\n\n  #setValue(value: string) {\n    this.#internals.setFormValue(value);\n    this.value = value as this['value'];\n    if (this.dispatchEvent(new ContextChangeEvent(this.value))) {\n      this.sync();\n    }\n  }\n\n  sync() {\n    if (this.value) {\n      this.#target?.setAttribute('color-palette', this.value);\n    }\n  }\n}\n"]}