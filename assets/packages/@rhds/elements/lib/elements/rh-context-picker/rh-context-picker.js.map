{"version":3,"file":"rh-context-picker.js","sourceRoot":"","sources":["rh-context-picker.ts"],"names":[],"mappings":"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","sourcesContent":["import { html, LitElement } from 'lit';\nimport { customElement } from 'lit/decorators/custom-element.js';\nimport { property } from 'lit/decorators/property.js';\n\nimport { type ColorPalette } from '../../context/color/provider.js';\nimport { colorContextConsumer, type ColorTheme } from '../../context/color/consumer.js';\n\nimport type { Color } from '@rhds/tokens/js/types.js';\nimport {\n  ColorSurfaceDarkest as darkest,\n  ColorSurfaceDarker as darker,\n  ColorSurfaceDark as dark,\n  ColorSurfaceLight as light,\n  ColorSurfaceLighter as lighter,\n  ColorSurfaceLightest as lightest,\n} from '@rhds/tokens/color.js';\n\nimport { classMap } from 'lit/directives/class-map.js';\n\nimport '@rhds/elements/rh-tooltip/rh-tooltip.js';\n\nimport style from './rh-context-picker.css';\nimport { InternalsController } from '@patternfly/pfe-core/controllers/internals-controller.js';\n\nexport class ContextChangeEvent extends Event {\n  constructor(public colorPalette: ColorPalette) {\n    super('change', { bubbles: true, cancelable: true });\n  }\n}\n\n@customElement('rh-context-picker')\nexport class RhContextPicker extends LitElement {\n  static formAssociated = true;\n\n  static readonly styles = [style];\n\n  static readonly palettes = new Map<ColorPalette, Color>(Object.entries({\n    darkest,\n    darker,\n    dark,\n    light,\n    lighter,\n    lightest,\n  }) as [ColorPalette, Color][]);\n\n  private static paletteNames = Array.from(RhContextPicker.palettes, ([name]) => name);\n\n  declare shadowRoot: ShadowRoot;\n\n  /** ID of context element to toggle (same root) */\n  @property() target?: string;\n\n  @property() value: ColorPalette = 'darkest';\n\n  @colorContextConsumer() private on?: ColorTheme;\n\n  @property({\n    converter: {\n      fromAttribute(list: string) {\n        return list?.split(',')\n            ?.map(x => x.trim())\n            ?.filter(x => RhContextPicker.paletteNames.includes(x as ColorPalette)) ?? [];\n      },\n      toAttribute(list: ColorPalette[]) {\n        return list.join(',');\n      },\n    },\n  }) allow = RhContextPicker.paletteNames;\n\n  #internals = InternalsController.of(this);\n\n  #target: HTMLElement | null = null;\n\n  render() {\n    const { allow, on = 'dark', value = 'darkest' } = this;\n    return html`\n      <div id=\"host-label\"\n           class=\"visually-hidden\">${this.#internals.computedLabelText}</div>\n      <div id=\"container\"\n           @input=\"${this.#onInput}\"\n           class=\"${classMap({ [`on-${on}`]: true })}\">\n        ${allow.map(palette => html`\n        <label for=\"radio-${palette}\" class=\"visually-hidden\">${palette}</label>\n        <rh-tooltip>\n          <span slot=\"content\">${palette}</span>\n          <input id=\"radio-${palette}\" class=\"${classMap({ [palette]: true })}\"\n                 name=\"palette\"\n                 type=\"radio\"\n                 value=\"${palette}\"\n                 aria-describedby=\"host-label\"\n                 ?checked=\"${value === palette}\">`)}\n        </rh-tooltip>\n      </div>\n    `;\n  }\n\n  formStateRestoreCallback(state: string) {\n    this.#setValue(state as this['value']);\n  }\n\n  firstUpdated() {\n    for (const label of this.#internals.labels) {\n      label.addEventListener('click', () => this.focus());\n    }\n    const oldTarget = this.#target;\n    if (this.target) {\n      const root = this.getRootNode() as Document | ShadowRoot;\n      this.#target = root.getElementById(this.target);\n      this.sync();\n    } else {\n      this.#target = this.closest('rh-surface');\n    }\n    oldTarget?.removeEventListener('change', this.#onChange);\n    this.#target?.addEventListener('change', this.#onChange);\n  }\n\n  #onChange(event: Event) {\n    if (event instanceof ContextChangeEvent) {\n      event.stopPropagation();\n    }\n  }\n\n  #onInput(event: Event) {\n    if (event.target instanceof HTMLInputElement && event.target.checked) {\n      event.stopPropagation();\n      const { value } = event.target;\n      if (value) {\n        this.#setValue(value as this['value']);\n      }\n    }\n  }\n\n  #setValue(value: this['value']) {\n    this.#internals.setFormValue(value);\n    if (value !== this.value && this.dispatchEvent(new ContextChangeEvent(value))) {\n      this.value = value;\n      this.sync();\n    }\n  }\n\n  override focus() {\n    const input: HTMLInputElement | null =\n         this.shadowRoot.querySelector('input[checked]')\n      ?? this.shadowRoot.querySelector('input');\n    input?.focus();\n  }\n\n  sync() {\n    if (this.value) {\n      this.#target?.setAttribute('color-palette', this.value);\n    }\n  }\n}\n"]}